---
layout: post
published: true
title: Ball Cups
date: 2018/11/16
---

>Youâ€™re going to play a game. Like many probability games, this one involves an infinite supply of ping-pong balls. No, this game is not quite beer pong.
>
>The balls are numbered 1 through N. There is also a group of N cups, labeled 1 through N, each of which can hold an unlimited number of ping-pong balls. The game is played in rounds. A round is composed of two phases: throwing and pruning.
>
>During the throwing phase, the player takes balls randomly, one at a time, from the infinite supply and tosses them at the cups. The throwing phase is over when every cup contains at least one ping-pong ball.
Next comes the pruning phase. During this phase the player goes through all the balls in each cup and removes any ball whose number does not match the containing cup.
Every ball drawn has a uniformly random number, every ball lands in a uniformly random cup, and every throw lands in some cup. The game is over when, after a round is completed, there are no empty cups.
>
>How many rounds would you expect to need to play to finish this game? How many balls would you expect to need to draw and throw to finish this game?

<!--more-->

([fivethirtyeight](https://fivethirtyeight.com/features/the-riddler-just-had-to-go-and-reinvent-beer-pong/))


## Solution

The "phases" are a red herring; the problem is to figure out how many tosses are needed before each cup has been filled with a ball of the same number.

Say that a cup it has a ball of the same number in it.

Since whatever numbered ball we throw there is a probability of $1/N$ that it will land in its proper cup, we know that the expected number of throws until the first cup is retired is $N$.

Now the chance that a ball will land in its proper cup is the chance, $(N-1)/N$, that we do not draw a ball for the retired cup, times the chance, $1/(N-1)$, that the ball lands in its proper cup.  So the chance that we retire a cup throwing a ball with one cup already retired is also $1/N$, and we expect $N$ throws to get to retire a second cup.

The reasoning iterates, so that with two cups retired, the per-ball chance is $(N-2)/N$ times $1/(N-2)$, or again $1/N$. And so on.  

So the total expected number of tosses is $N$ (for the $N$ cups that need to be retired) times $N$ (for the number of tosses always expected to retire the next cup), or $N^2$, which means $N$ rounds.

<br>
